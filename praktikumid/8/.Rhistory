ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid)
graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none") +
graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none")
graafik2
averages <- ylev %>%
filter(!is.na(KERETYYP)) %>%
mutate(M_group = case_when(
KERETYYP %in% c("M1", "M1G") ~ "M1_M1G",
KERETYYP %in% c("M2", "M3") ~ "M2_M3",
TRUE ~ NA_character_
)) %>%
filter(!is.na(M_group)) %>%
group_by(M_group) %>%
summarise(avg_vigade = mean(VIGADE_ARV, na.rm = TRUE))
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none")+
geom_vline(data = averages, aes(xintercept = avg_vigade, color = NULL),
linetype = "dashed", size = 1) +
# optionally add labels
geom_text(data = averages, aes(x = avg_vigade, y = max(as.numeric(factor(ylev$KERETYYP))) + 0.5,
label = paste0(M_group, " avg")),
angle = 90, vjust = -0.5, hjust = 0, color = "black")
graafik2
averages <- ylev %>%
filter(!is.na(KERETYYP)) %>%
mutate(M_group = case_when(
KERETYYP %in% c("M1", "M1G") ~ "M1_M1G",
KERETYYP %in% c("M2", "M3") ~ "M2_M3",
TRUE ~ NA_character_
)) %>%
filter(!is.na(M_group)) %>%
group_by(M_group) %>%
summarise(avg_vigade = mean(VIGADE_ARV, na.rm = TRUE))
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none")+
# add average lines
geom_vline(data = averages, aes(xintercept = avg_vigade, color = NULL),
linetype = "dashed", size = 1) +
# optionally add labels
geom_text(data = averages, aes(x = avg_vigade, y = max(as.numeric(factor(ylev$KERETYYP))) + 0.5,
label = paste0(M_group, " avg")),
angle = 90, vjust = -0.5, hjust = 0, color = "black")
graafik2
averages
averages <- ylev %>%
filter(!is.na(KATEGOORIA)) %>%
mutate(M_group = case_when(
KATEGOORIA %in% c("M1", "M1G") ~ "M1_M1G",
KATEGOORIA %in% c("M2", "M3") ~ "M2_M3",
TRUE ~ NA_character_
)) %>%
filter(!is.na(M_group)) %>%
group_by(M_group) %>%
summarise(avg_vigade = mean(VIGADE_ARV, na.rm = TRUE))
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none")+
# add average lines
geom_vline(data = averages, aes(xintercept = avg_vigade, color = NULL),
linetype = "dashed", size = 1) +
# optionally add labels
geom_text(data = averages, aes(x = avg_vigade, y = max(as.numeric(factor(ylev$KERETYYP))) + 0.5,
label = paste0(M_group, " avg")),
angle = 90, vjust = -0.5, hjust = 0, color = "black")
graafik2
averages <- ylev %>%
filter(!is.na(KATEGOORIA)) %>%
mutate(M_group = case_when(
KATEGOORIA %in% c("M1", "M1G") ~ "M1_M1G",
KATEGOORIA %in% c("M2", "M3") ~ "M2_M3",
TRUE ~ NA_character_
)) %>%
filter(!is.na(M_group)) %>%
group_by(M_group) %>%
summarise(avg_vigade = mean(VIGADE_ARV, na.rm = TRUE))
averages
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none")
#graafik2
graafik1 / graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_jitter() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none")
#graafik2
#graafik
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_jitter() +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none")
graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point(position = "jitter"),
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KERETYYP)) %>%
group_by(KERETYYP) %>%
ggplot(aes(y = KERETYYP, x = VIGADE_ARV, color=KATEGOORIA)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)+
scale_color_manual(values = kategooria_värvid) +
theme(legend.position = "none")
graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)
graafik2
graafik1 / graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)
graafik2
#unique(ylev$YLEVAATUSOTSUS)
unique(ylev$KERETYYP)
ylev <- ylevaatused %>%
mutate(
RIKKED = ifelse(is.na(RIKKED), "", RIKKED),
VIGADE_ARV = ifelse(RIKKED == "", 0, str_count(RIKKED, ";") + 1),
) %>%
filter(str_starts(KATEGOORIA, "M") & !is.na(KATEGOORIA)) %>%
mutate(KERETYYP_GRUPP = case_when(
KERETYYP %in% c("MAHTUNIVERSAAL", "UNIVERSAAL", "LUUKPÄRA", "SEDAAN",
"KUPEE", "LIMUSIIN", "KOMBI") ~ "Sõiduauto",
KERETYYP %in% c("MITMEOTSTARBELINE SÕIDUK", "PIKAP", "LAHTINE",
"SIHTOTSTARBELINE", "ERIOTSTARBELINE SÕIDUK") ~ "Kaubik / MPV",
KERETYYP %in% c("BUSS", "LIIGENDBUSS", "KORRUSBUSS", "TROLL") ~ "Buss",
KERETYYP %in% c("KIIRABI", "ELAMU", "MATUSEAUTO") ~ "Erisõiduk",
TRUE ~ "Määramata"
))
#sample_n(20000)
ylev
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)
graafik2
ylev <- ylevaatused %>%
mutate(
RIKKED = ifelse(is.na(RIKKED), "", RIKKED),
VIGADE_ARV = ifelse(RIKKED == "", 0, str_count(RIKKED, ";") + 1),
) %>%
filter(str_starts(KATEGOORIA, "M") & !is.na(KATEGOORIA)) %>%
mutate(KERETYYP_GRUPP = case_when(
KERETYYP %in% c("MAHTUNIVERSAAL", "UNIVERSAAL", "LUUKPÄRA", "SEDAAN",
"KUPEE", "LIMUSIIN", "KOMBI") ~ "Sõiduauto",
KERETYYP %in% c("LAHTINE", "PIKAP",
"SIHTOTSTARBELINE", "ERIOTSTARBELINE SÕIDUK") ~ "Kaubik / tööauto",
KERETYYP %in% c("MITMEOTSTARBELINE SÕIDUK") ~ "Mitmeotstarbeline",
KERETYYP %in% c("BUSS", "LIIGENDBUSS", "KORRUSBUSS", "TROLL") ~ "Buss",
KERETYYP %in% c("KIIRABI", "MATUSEAUTO", "ELAMU") ~ "Erisõiduk",
TRUE ~ NA
))
#sample_n(20000)
ylev
#unique(ylev$YLEVAATUSOTSUS)
unique(ylev$KERETYYP)
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
) +
theme_minimal(base_size = 12)
graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
color = "Keretüüp"
) +
theme_minimal(base_size = 12)
graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
color = "Keretüüp"
) +
theme_minimal(base_size = 12)
#graafik2
graafik1 / graafik2
graafik1 / graafik2 +
plot_layout(guides = "keep")
# Vanus vs mitte_positiivne ülevaatusotsus (M1 ja m1g kategooria (sõiduuatod ja bussid))
library(scales)
palett = hue_pal()(8)
kategooria_värvid = c(
"M1"     = palett[2],
"M1G"    = palett[4],
"M2"     = palett[6],
"M3"     = palett[8]
)
m1_m1g <- ylev %>%
filter(!is.na(ESMANE_REG_AASTA), !is.na(YLEVAATUSOTSUS)) %>%
filter(YLEVAATUSOTSUS %in% c("EI_VASTA_NOUETELE", "SOITMISEKS_KOLBMATU")) %>%
filter(KATEGOORIA %in% c("M1", "M1G")) %>%
ggplot(aes(x = ESMANE_REG_AASTA, color = KATEGOORIA, fill = KATEGOORIA)) +
geom_density(alpha = 0.2) +
labs(
title = "Sõiduautod",
x = "Esmane registreerimse aasta",
y = "Tihedus",
fill = "Kategooria",
color = "Kategooria"
) +
theme_minimal(base_size = 12) +
theme(plot.title = element_text(face = "plain", size = 12)) +
scale_color_manual(values = kategooria_värvid) +
scale_fill_manual(values = kategooria_värvid)
m2_m3 <- ylev %>%
filter(!is.na(ESMANE_REG_AASTA), !is.na(YLEVAATUSOTSUS)) %>%
filter(YLEVAATUSOTSUS %in% c("EI_VASTA_NOUETELE", "SOITMISEKS_KOLBMATU")) %>%
filter(KATEGOORIA %in% c("M2", "M3")) %>%
ggplot(aes(x = ESMANE_REG_AASTA, color = KATEGOORIA, fill = KATEGOORIA)) +
geom_density(alpha = 0.2) +
labs(
title = "Bussid",
x = "Esmane registreerimse aasta",
y = "Tihedus",
fill = "Kategooria",
color = "Kategooria"
) +
theme_minimal(base_size = 12) +
theme(plot.title = element_text(face = "plain", size = 12)) +
scale_color_manual(values = kategooria_värvid) +
scale_fill_manual(values = kategooria_värvid)
graafik1 <- m1_m1g / m2_m3 +
plot_layout(guides = "collect") +
plot_annotation(
title = "Negatiivne ülevaatusotsus",
subtitle = "M-kategooria sõidukid",
#caption = "Allikas: ?? trust me bro",
theme = theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12)
)
)
#graafik1
graafik1 / graafik2 +
plot_layout(guides = "keep")
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
color = "Keretüüp"
) +
theme_minimal(base_size = 12) +
theme = theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12)
)
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
color = "Keretüüp"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12)
)
#graafik2
graafik1 / graafik2 +
plot_layout(guides = "keep")
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
y = "Keretüüp",
x = "Vigade Arv",
color = "Keretüüp"
) +
plot_annotation(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
theme = theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12)
)
#graafik2
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
y = "Keretüüp",
x = "Vigade Arv",
color = "Keretüüp"
) +
plot_annotation(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
theme = theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12)
)
)
#graafik2
graafik1 / graafik2 +
plot_layout(guides = "keep")
# Auto kategooria ja vigade arv
graafik2 <- ylev %>%
filter(!is.na(KATEGOORIA), !is.na(KERETYYP_GRUPP)) %>%
group_by(KATEGOORIA) %>%
ggplot(aes(y = KATEGOORIA, x = VIGADE_ARV, color=KERETYYP_GRUPP)) +
geom_point(position = "jitter") +
labs(
title = "Vigade arv keretüübi kohta",
subtitle = "M-kategooria sõidukid",
y = "Keretüüp",
x = "Vigade Arv",
color = "Keretüüp"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12)
)
#graafik2
graafik1 / graafik2 +
plot_layout(guides = "keep")
